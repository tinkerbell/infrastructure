driver:
  name: docker
  use_sudo: false
  privileged: true
  run_command: /lib/systemd/systemd

platforms:
  - name: ubuntu-2004-3002-2-py3
    driver:
      image: saltimages/salt-3002.2-py3:ubuntu-20.04

# This isn't configured great at all, but sadly the docs
# are useless and the code not much better:
# https://github.com/saltstack/kitchen-salt/blob/master/lib/kitchen-salt/states.rb
# The current configurion requires "local" includes within states, like "." within docker.test
# and calling "states.docker.test" in the top file below.
provisioner:
  name: salt_solo
  log_level: debug
  salt_install: none
  require_chef: false
  salt_file_root: srv/salt
  formula: ./states
  salt_copy_filter:
    - .kitchen

suites:
  - name: default
    provisioner:
      state_top:
        base:
          "*":
            - states.docker
            - states.github-actions.runner
